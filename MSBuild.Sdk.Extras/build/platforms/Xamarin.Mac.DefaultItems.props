<Project>
  <PropertyGroup>
    <MSBuildAllProjects>$(MSBuildAllProjects);$(MSBuildThisFileFullPath)</MSBuildAllProjects>
  </PropertyGroup>

  <ItemGroup Condition="'$(EnableDefaultItems)' == 'true' and '$(EnableDefaultPlatformItems)' == 'true'">
    <!-- This is imported and updated without a condition on TF because the IDE uses the first TF
         in order to render the solution explorer, so the platform-specific file will have to be 
         imported there (as None, by default) and have the proper DependentUpon -->

    <Compile Remove="Mac/**/*$(_SdkLanguageExtension)" Condition="'$(EnableDefaultCompileItems)' == 'true'" />
    <None Include="Mac/**/*$(_SdkLanguageExtension)" Condition="'$(EnableDefaultNoneItems)' == 'true'" />

    <Compile Remove="**/*.Mac$(_SdkLanguageExtension)" Condition="'$(EnableDefaultCompileItems)' == 'true'" />
    <None Include="**/*.Mac$(_SdkLanguageExtension)"
          DependentUpon="$([MSBuild]::ValueOrDefault('%(Filename)', '').Replace('.Mac', ''))$(_SdkLanguageExtension)"
          SubType="Code"
          Condition="'$(EnableDefaultNoneItems)' == 'true'" />

    <!-- This works in concert with MSBuild.Sdk.Extras.DefaultItems.targets where *.[TF][TFV].cs is added as compile,
         but we need to remove them from Compile globally otherwise they are added by the global compile import of **/*.cs -->
    <Compile Remove="**/*.xamarinmac*$(_SdkLanguageExtension)" Condition="'$(EnableDefaultCompileItems)' == 'true'" />
    <None Include="**/*.xamarinmac*$(_SdkLanguageExtension)"
          DependentUpon="$([System.Text.RegularExpressions.Regex]::Replace($([MSBuild]::ValueOrDefault('%(Filename)', '')), '\.xamarinmac\d?(\.\d)?', ''))$(_SdkLanguageExtension)"
          SubType="Code"
          Condition="'$(EnableDefaultNoneItems)' == 'true'" />
  </ItemGroup>

</Project>